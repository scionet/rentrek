<div class="container-lg">
  <h1>My Profile Page</h1>
  <hr>
  <div class="row">
    <div class="col-4">
      <div class="card shadow p-3 mb-5 bg-body rounded" style="width: 18rem;">
        <div class="card-body">
          <h5 class="card-title">username placeholder</h5>
          <h6 class="card-subtitle mb-2 text-muted"><p><%= @user.email %></p></h6>
          <p class="card-text">This user is lazy. They didn't leave any message here.</p>
          <a href="#" class="card-link">edit_placeholder</a>
        </div>
      </div>
    </div>
    <div class="col-8">
      <div class="card mb-4">
        <div class="card-body">
          <h2>My Equipment</h2>
            <hr>
            <% @all_my_equipment.each do |equipment| %>
            <div class="d-flex justify-content-between">
              <div class="mb-4">
                <p><%= equipment.name%></p>
                <p class="text-secondary"><%= equipment.description %></p>
              </div>
              <div class="dropdown">
                <div class="ml-4">
                  <button class="btn btn-secondary btn-sm dropdown-toggle ml-2"  data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Actions
                  </button>
                  <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                    <%= link_to "View", equipment_path(equipment), class: "dropdown-item" %>
                    <%= link_to "Edit", edit_equipment_path(equipment), class: "dropdown-item" %>
                  </div>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      </div>
      <div class="card mb-4">
        <div class="card-body">
          <h2>My Reservations</h2>
          <hr>
          <% @my_reservations.each do |reservation| %>
            <div class="d-flex justify-content-between mb-2">
              <div>
                <%= reservation.equipment.name %> : 
                <%= reservation.start_date %> ~
                <%= reservation.end_date %> |          
              </div>
              <div class="dropdown">
                <div class="d-flex ml-4">
                  <div class="text-secondary"><%= reservation.status %></div>
                  <button class="btn btn-secondary btn-sm dropdown-toggle ml-2"  data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Actions
                  </button>
                  <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                    <%= link_to "View", reservation_path(reservation), class: "dropdown-item" %>
                    <% if reservation.status == "Pending" %>
                      <%= link_to "Edit", edit_reservation_path(@reservation) %>
                      <%= link_to "Cancel", cancel_reservation_path(@reservation), method: :post %>
                    <% end %>
                  </div>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      </div> 
      <div class="card mb-4">
        <div class="card-body">
          <h2>Incoming Requests</h2>
          <hr>
          <% @all_my_equipment.each do |equipment| %>
            <% if equipment.reservations.present? %>
              <% equipment.reservations.each do |reservation| %>
                <div class="d-flex justify-content-between mb-2">
                  <div>
                    <%= reservation.user.email %> wants to rent 
                    <%= equipment.name %> for 
                    <%= reservation.start_date %> to <%= reservation.end_date %>
                  </div>
                  <div class="d-flex ml-4">
                    <p class="text-secondary"><%= reservation.status %></p>
                    <div class="dropdown">
                      <button class="btn btn-secondary btn-sm dropdown-toggle ml-2"  data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Actions
                      </button>
                      <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                        <%= link_to "View", reservation_path(reservation), class: "dropdown-item" %>
                        <% if reservation.status == "Pending" %>
                          <%= link_to "Accept", accept_reservation_path(reservation), method: :post %>
                          <%= link_to "Edit", edit_reservation_path(reservation) %>
                          <%= link_to "Reject", reject_reservation_path(reservation), method: :post %>
                        <% end %>
                      </div>
                    </div>
                  </div>
                </div>
              <% end %>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>